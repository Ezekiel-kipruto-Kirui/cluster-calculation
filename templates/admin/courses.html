{% extends "base.html" %}

{% block title %}All Courses{% endblock %}

{% block top_actions %}
<a href="{{ url_for('main.admin_dashboard') }}" class="rounded-md px-3 py-2 text-slate-700 transition hover:bg-slate-100">
    Dashboard
</a>
<a href="{{ url_for('main.add_course_page') }}" class="rounded-md px-3 py-2 text-slate-700 transition hover:bg-slate-100">
    Add Course
</a>
<a href="{{ url_for('main.logout') }}" class="rounded-md bg-rose-50 px-3 py-2 text-rose-700 transition hover:bg-rose-100">
    Logout
</a>
{% endblock %}

{% block content %}
<section class="space-y-6">
    <div>
        <h1 class="text-2xl font-semibold tracking-tight text-slate-900">All Courses</h1>
        <p class="mt-2 text-sm text-slate-600">Grouped by cluster with quick edit and delete actions.</p>
    </div>

    {% if courses %}
        {% for cluster, course_list in courses.items() %}
        <article class="rounded-xl border border-slate-200 bg-white p-5 shadow-sm">
            <h2 class="text-lg font-semibold text-slate-900">Cluster {{ cluster }}</h2>

            <div class="mt-4 overflow-x-auto">
                <table class="min-w-full divide-y divide-slate-200 text-sm">
                    <thead class="bg-slate-50 text-left text-slate-700">
                        <tr>
                            <th class="px-3 py-2 font-semibold">Course</th>
                            <th class="px-3 py-2 font-semibold">University</th>
                            <th class="px-3 py-2 font-semibold">Cutoff</th>
                            <th class="px-3 py-2 font-semibold">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-100 bg-white text-slate-700">
                        {% for course in course_list %}
                        <tr class="hover:bg-slate-50">
                            <td class="px-3 py-2 font-medium text-slate-900">{{ course.name }}</td>
                            <td class="px-3 py-2">
                                {% if course.university %}
                                    {{ course.university }}
                                {% else %}
                                    <span class="text-slate-400">Not set</span>
                                {% endif %}
                            </td>
                            <td class="px-3 py-2">
                                {% if course.cutoff is not none %}
                                    {{ course.cutoff }}
                                {% else %}
                                    <span class="text-slate-400">Not set</span>
                                {% endif %}
                            </td>
                            <td class="px-3 py-2">
                                <div class="flex items-center gap-2">
                                    <a
                                        href="{{ url_for('main.edit_course', course_id=course.id) }}"
                                        class="inline-flex items-center rounded-md border border-slate-300 px-2.5 py-1.5 text-xs font-medium text-slate-700 transition hover:bg-slate-100"
                                    >
                                        Edit
                                    </a>
                                    <form method="post" action="{{ url_for('main.delete_course', course_id=course.id) }}">
                                        <button
                                            type="submit"
                                            onclick="return confirm('Delete this course?')"
                                            class="inline-flex items-center rounded-md border border-rose-200 bg-rose-50 px-2.5 py-1.5 text-xs font-medium text-rose-700 transition hover:bg-rose-100"
                                        >
                                            Delete
                                        </button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </article>
        {% endfor %}
    {% else %}
    <div class="rounded-md border border-slate-200 bg-white px-4 py-3 text-sm text-slate-600">
        No courses added yet.
    </div>
    {% endif %}
</section>
{% endblock %}
